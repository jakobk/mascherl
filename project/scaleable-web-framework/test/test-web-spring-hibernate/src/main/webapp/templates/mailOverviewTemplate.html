{{< pageTemplate}}

{{$content}}

<div class="well well-sm">
    <button id="deleteBtn" type="button" class="btn btn-default" aria-label="Delete">
        <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
    </button>
    <script>
        // TODO mascherl must provide a better way for doing this
        $("#deleteBtn").click(function() {
            var mailDeleteForm = $("#mailDeleteForm");
            mailDeleteForm.empty();
            $("input.messageSelect:checked").each(function() {
                mailDeleteForm.append($('<input type="hidden" name="mailUuid" value="' + $(this).attr("data-uuid") + '" />'));
            });
            var pageParameter = getParameterByName("page");
            if (pageParameter !== "") {
                mailDeleteForm.append($('<input type="hidden" name="page" value="' + pageParameter + '" />'));
            }
            mailDeleteForm.submit();
        });
    </script>
</div>

{{$mailTypeNav}}
{{/mailTypeNav}}

<p></p>
<p>You have {{mailCount}} e-mails.</p>

<table class="table">
    <tr>
        <th>
            <label>
                <input id="messageSelectAll" type="checkbox" aria-label="select all messages" />
                <script>
                    $("#messageSelectAll").click(function() {
                        $(".messageSelect").prop("checked", $(this).prop("checked"));
                    });
                </script>
            </label>
        </th>
        <th>From</th>
        <th>Subject</th>
        <th>Date</th>
    </tr>
    {{#mails}}
        <tr>
            <td>
                <label>
                    <input type="checkbox" class="messageSelect" data-uuid="{{uuid}}" aria-label="select message {{subject}}" />
                </label>
            </td>
            <td{{#isUnread}} style="font-weight:bold;"{{/isUnread}}><a href="/mail/{{uuid}}">{{fromTo}}</a></td>
            <td{{#isUnread}} style="font-weight:bold;"{{/isUnread}}><a href="/mail/{{uuid}}">{{subject}}</a></td>
            <td{{#isUnread}} style="font-weight:bold;"{{/isUnread}}><a href="/mail/{{uuid}}">{{dateTime}}</a></td>
        </tr>
    {{/mails}}
    {{^mails}}
        <tr>
            <td colspan="4"><i>No e-mails.</i></td>
        </tr>
    {{/mails}}
</table>

<form id="mailDeleteForm" action="/mail/moveToTrash" method="post">
</form>

<script>
    $(".messageSelect").click(function() {
        $("#messageSelectAll").prop("checked", false);
    });
</script>

{{/content}}

{{/pageTemplate}}